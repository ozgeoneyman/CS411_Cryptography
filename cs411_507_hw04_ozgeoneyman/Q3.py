import random
import sympy
import warnings

def egcd(a, b):
    x,y, u,v = 0,1, 1,0
    while a != 0:
        q, r = b//a, b%a
        m, n = x-u*q, y-v*q
        b,a, x,y, u,v = a,r, u,v, m,n
    gcd = b
    return gcd, x, y

def modinv(a, m):
    if a < 0:
        a = a+m
    gcd, x, y = egcd(a, m)
    if gcd != 1:
        return None  # modular inverse does not exist
    else:
        return x % m


q = 21951366550493000718261853105201996539940614036945856492989212434043
p = 19088517355831130409934748378779805905302705641965364159942125090101617999753027018189667983545289186285230294418641605036825240678097397395230404359507071559404389248216599778765719713846458305369800636274222016830546342326148389081626885189560815658702360521026851058633029338654212437141532481678718233170785139259807373498180114308976944784406655175400625539527446266874803273512004508308289383817366261385711471144678517608879306099468067802238512104280975543754563520312324843005014163082784867067493063831332232307885072030133009137003833145105538537740573073700482783653386269696771584777005458361676730195269
g =11087495091603530820155897131840473261858409884534929785120936970350376598340442896883574641744696479628472624342359272151637539136895933617939030520391407184416708907013487615191809710078909741359360000857256395044892863044815125384716347435813066195815485624291719443466688879049424007911844446338806244185922330210312707943825392115584470267705273405180223953409232759887005501695597823928207755310578554603601919724666809527816369888108811510878478538472275092154183239479881736342603225650419112774665516766240118002532725372593205923027699351646411194158590763916065051068576064011732461215932399447248837314410
h = 9873203779178244917358573822108714866225564575093808381213522055099626905048574718377079843991839510388942447133846967681289456819947370683826286030503502818500718154811587937671538870397020394696916846477396598261743047774222401970648745921252876334052024434425956082895113727370027472890009184908903484272749740481915199204657643903755451357580121147257489190540902783014119846189925404957135796518635962375070882459865458127443035772212293255428264034049635490612261573387887524888802067164904993484937321856473479363757660548251755432575453310770104973287194502039014525475315126375676115874359038819330713241291        
r = 13239165462296247473198286084973383864996378253136557740429521719144063831821729177799399305950848429010164591542578562684023946241096301139746873125185337885249707659168493942789313819744667335619045753900506240369136086623859500236018345087286259769447189948020380571433737454919151202571220238401902685316173160652664728814802730286862716501856130474861597834557394410064220660262951086473381213872001001812089245177295323999087622201098124683901064700236434898763210368066565620049984903773379389046508917805706757074599173912975537261341906213763409479276421831618970202312256091485549555360990937615951232838268
t= 2928045218382913457443684144012119252158702606935650406082722909043750222063535952568445399246549338686535905837513361362432352310427915617009889512798700889425377290088743179267273148885243724087310940896340921032631826293301818196131007722811813618752139364912766264315045693874444132957516084576903717991215125921734695027091167528772436766134863043017918248307711681264405247655082037392265448812667466816921749084328029750765491112978016172077944711575384560448985809167799882976912165824870025790728459775008685965071079143643944588549757339336699279861653817076680172669373971736606326598544835667466271193204

a = 2**16
a = 65535

for i in range(1, a):
  if r == pow(g,i,p):
    k = i
    break

message = (t * (pow(modinv( h, p ), k, p ) ) ) % p            ### The message is: I am gonna make him an offer he cannot refuse
print(message.to_bytes((message.bit_length() + 7 ) // 8, byteorder='big'))